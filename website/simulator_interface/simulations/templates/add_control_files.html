<!DOCTYPE html>

{% extends "base_framework.html" %}

<head>
	<title>
	</title>
</head>

<body>
	<br><br>
	{% block main_body_content %}
		<form action="" method="post">
		
		{% if control_file_form %}
			<p>Browse your computer and upload the control (.py) files. All the files must be in the same directory 
			as the working directory above.</p>
			<table>
				{% for control_item in control_file_form %}
					<tr>
						<td style="text-align:left; padding:25px"> {{ forloop.counter }}. </td>
						<td>
							{% if control_item.0 %}
								<table>
								<tr>
									<td style="right-padding:35px">
										<table>
											<tr style="padding:15px">
												<td>File name: </td>
												<td>{{ control_item.0.control_file_name }}</td>
											</tr>
											<tr>
												<td>File description:</td>
												<td>{{ control_item.0.control_file_descrip }}</td>
											</tr>
										</table>
									</td>
									<td style="left-padding:35px">
									<input type="submit" name="config_control_id_{{ control_item.0.id }}" Value="Configure control"> <br>
									</td>
								</tr>
								</table>
								{% for control_error_item in control_item.1 %}
									{% if control_error_item %}
										{% for all_control_errors in control_error_item.errors %}
												<font color="red"> {{ all_control_errors }} </font> <br>
										{% endfor %}
									{% endif %}
								{% endfor %}
								Want to change this file? <br> Click
								<input type="submit" name="change_control_id_{{ control_item.0.id }}" Value="Remove control">
								and add another one using "Add control" button below. <br><br>
							{% else %}
								<table>
									{% for control_field in control_item.1 %}
									<tr>
										<td>{{ control_field.label }}</td>
										<td> {{ control_field }}
										{% if control_field.errors %}
											{% for all_control_errors in control_field.errors %}
												<font color="red"> {{ all_control_errors }} </font>
											{% endfor %}
										{% endif %}</td>
									</tr>
									{% endfor %}
									<tr>
										<td></td>
										<td><input type="submit" name="save_control" value="Save control file"></td>
									</tr>
								</table>
							{% endif %}
						</td>
					</tr>
				{% endfor %}
			</table>
			<br>
			<input type="submit" name="add_control" value="Add control file">
			Use this button to add control files.
			<br> <br>
			<input type="submit" name="main_page" value="Back to main page">
		{% endif %}
		<input type="hidden" name="sim_id" value="{{ sim_id }}">
		<input type="hidden" name="sim_state" value="{{ sim_state }}">
		{% if ckt_error_list %}
			<br><br>
			<p>There are the following errors in the circuits above. You must resolve these errors and click on the 
			"Process circuit schematics" button above to check for errors again:</p>
			<ol>
				{% for ckt_error_item in ckt_error_list %}
					<li>{{ ckt_error_item }}</li>
				{% endfor %}
			</ol>
		{% else %}
			{% if ckt_errors == 0 %}
				<p>The circuits do not have any detectable errors. You can continue to enter the 
				parameters by clicking on the "Back to main page" button.</p>
			{% endif %}
		{% endif %}
		{% csrf_token %}
		</form>
	{% endblock %}
</body>